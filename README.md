# 아이케어(iOnnuri) 순배정 자동화 시스템

이 프로그램은 아이케어(iOnnuri) 웹사이트에서 순배정(다락방 및 순장 배정) 작업을 자동으로 수행하는 도구입니다.

---

## 📋 목차

1. [프로그램이 하는 일](#프로그램이-하는-일)
2. [사전 준비사항](#사전-준비사항)
3. [설치 방법 (단계별)](#설치-방법-단계별)
4. [CSV 파일 준비하기](#csv-파일-준비하기)
5. [프로그램 실행하기](#프로그램-실행하기)
6. [실행 결과 확인하기](#실행-결과-확인하기)
7. [문제 해결 (트러블슈팅)](#문제-해결-트러블슈팅)
8. [주의사항](#주의사항)

---

## 프로그램이 하는 일

이 프로그램은 다음과 같은 작업을 자동으로 수행합니다:

1. 아이케어 웹사이트에 자동으로 로그인
2. CSV 파일에 있는 사람들의 이름을 검색
3. 각 사람에게 다락방과 순장을 자동으로 배정
4. 작업 완료 후 결과 요약 제공

**수동으로 수십 명, 수백 명의 순배정을 하는 대신, CSV 파일만 준비하면 자동으로 처리됩니다!**

---

## 사전 준비사항

프로그램을 실행하기 전에 다음 항목들이 준비되어 있어야 합니다:

### ✅ 필수 항목

1. **컴퓨터**: Windows, Mac, 또는 Linux 운영체제
2. **인터넷 연결**: 안정적인 인터넷 연결 필요
3. **아이케어 계정**: 아이케어 웹사이트에 로그인할 수 있는 관리자 계정
4. **Google Chrome 브라우저**: 최신 버전 설치 필요
5. **Python 3.7 이상**: 설치되어 있어야 함

### 📝 확인 방법

#### Python 설치 확인
1. **Windows 사용자**:
   - 키보드에서 `Windows 키 + R`을 누릅니다
   - `cmd`를 입력하고 Enter를 누릅니다
   - 검은 창(명령 프롬프트)에서 `python --version`을 입력하고 Enter를 누릅니다
   - `Python 3.7.x` 또는 그 이상 버전이 나오면 설치되어 있는 것입니다
   - 만약 "Python이 인식되지 않습니다"라는 메시지가 나오면 Python을 설치해야 합니다

2. **Mac 사용자**:
   - 터미널을 엽니다 (Spotlight에서 "터미널" 검색)
   - `python3 --version`을 입력하고 Enter를 누릅니다
   - 버전이 나오면 설치되어 있는 것입니다

3. **Python이 설치되어 있지 않은 경우**:
   - https://www.python.org/downloads/ 에서 다운로드하여 설치하세요
   - 설치 시 **"Add Python to PATH"** 옵션을 반드시 체크하세요 (Windows)

---

## 설치 방법 (단계별)

### 1단계: 프로젝트 폴더 확인

1. 이 파일(README.md)이 있는 폴더를 찾습니다
2. 폴더 안에 다음 파일들이 있는지 확인합니다:
   - `icare_auto_assign.py` (메인 프로그램 파일)
   - `data.csv` (데이터 파일)
   - `README.md` (이 파일)

### 2단계: 명령 프롬프트(터미널) 열기

**Windows 사용자:**
1. 프로젝트 폴더로 이동합니다
2. 폴더 안에서 빈 공간을 **우클릭**합니다
3. "터미널에서 열기" 또는 "Open in Terminal" 또는 "PowerShell에서 열기"를 선택합니다
   - 또는 `Windows 키 + R` → `cmd` 입력 → Enter → `cd 폴더경로` 입력

**Mac 사용자:**
1. Finder에서 프로젝트 폴더를 엽니다
2. 폴더 안에서 빈 공간을 **우클릭**합니다
3. "서비스" → "폴더에서 새 터미널"을 선택합니다
   - 또는 Spotlight에서 "터미널" 검색 후 열고, `cd` 명령어로 폴더로 이동합니다

### 3단계: 필요한 라이브러리 설치

명령 프롬프트(터미널)에서 다음 명령어를 **하나씩** 입력하고 Enter를 누릅니다:

```bash
pip install selenium
```

입력 후 잠시 기다리면 설치가 진행됩니다. "Successfully installed"라는 메시지가 나오면 성공입니다.

**만약 `pip` 명령어가 작동하지 않는 경우:**
- Windows: `python -m pip install selenium` 시도
- Mac: `python3 -m pip install selenium` 시도

다음 명령어도 실행합니다:

```bash
pip install webdriver-manager
```

**Mac 사용자의 경우:**
```bash
pip3 install selenium webdriver-manager
```

### 4단계: 설치 확인

다음 명령어로 설치가 잘 되었는지 확인합니다:

```bash
python -c "import selenium; print('Selenium 설치 완료!')"
```

**Mac 사용자의 경우:**
```bash
python3 -c "import selenium; print('Selenium 설치 완료!')"
```

"Selenium 설치 완료!"라는 메시지가 나오면 성공입니다.

---

## CSV 파일 준비하기

### CSV 파일이란?

CSV 파일은 엑셀처럼 표 형식의 데이터를 저장하는 파일입니다. 이 프로그램은 `data.csv` 파일을 읽어서 순배정 작업을 수행합니다.

### CSV 파일 형식

`data.csv` 파일은 반드시 다음 형식을 따라야 합니다:

| 다락방 | 순장 | 이름 | 연락처 |
|--------|------|------|--------|
| 다락방1 | 순장1 | 홍길동 | 01012345678 |
| 다락방2 | 순장2 | 김철수 | 01098765432 |

⚠️ **중요 사항:**
- **연락처는 선택 사항입니다**: 연락처가 없어도 빈 칸으로 두거나 생략할 수 있습니다
- **동명이인은 입력 불가**: CSV 파일 내에 동명이인이 있거나, 아이케어 시스템에 동명이인이 등록되어 있으면 자동으로 제외됩니다

### CSV 파일 만들기 (엑셀 사용)

1. **Microsoft Excel** 또는 **Google Sheets**를 엽니다

2. 첫 번째 줄(헤더)에 다음을 입력합니다:
   ```
   다락방,순장,이름,연락처
   ```
   ⚠️ **중요**: 쉼표(`,`)로 구분해야 합니다. 탭이나 공백이 아닙니다!

3. 두 번째 줄부터 데이터를 입력합니다:
   ```
   다락방1,순장1,홍길동,01012345678
   다락방2,순장2,김철수,01098765432
   다락방3,순장3,이영희,01011112222
   ```
   💡 **참고**: 연락처가 없으면 빈 칸으로 두거나 생략할 수 있습니다 (예: `다락방1,순장1,홍길동,`)

4. **파일 저장**:
   - Excel: "다른 이름으로 저장" → 파일 형식을 **"CSV UTF-8(쉼표로 구분)(*.csv)"** 선택
   - 파일 이름을 `data.csv`로 저장
   - 저장 위치는 프로젝트 폴더(icare_auto_assign.py가 있는 폴더)로 지정

### CSV 파일 만들기 (메모장 사용)

1. **메모장**(Windows) 또는 **텍스트 편집기**(Mac)를 엽니다

2. 다음 형식으로 입력합니다:
   ```
   다락방,순장,이름,연락처
   다락방1,순장1,홍길동,01012345678
   다락방2,순장2,김철수,01098765432
   ```

3. **파일 저장**:
   - 파일 이름: `data.csv`
   - 인코딩: **UTF-8** 선택 (저장 시 "인코딩" 옵션에서 선택)
   - 저장 위치: 프로젝트 폴더

### CSV 파일 작성 시 주의사항

✅ **해야 할 것:**
- 첫 번째 줄은 반드시 헤더(다락방,순장,이름,연락처)여야 합니다
- 각 줄은 쉼표(`,`)로 구분합니다
- 이름은 정확하게 입력합니다 (아이케어 시스템에 등록된 이름과 동일해야 함)
- **연락처는 선택 사항입니다**: 없어도 빈 칸으로 두거나 생략 가능합니다
- 연락처가 있는 경우, 하이픈(`-`) 없이 숫자만 입력해도 됩니다 (프로그램이 자동으로 처리)
- 다락방 이름과 순장 이름은 정확하게 입력합니다 (대소문자, 띄어쓰기 주의)

❌ **하지 말아야 할 것:**
- 빈 줄을 남기지 않습니다
- 헤더 이름을 변경하지 않습니다 (다락방, 순장, 이름, 연락처)
- **동명이인은 입력 불가**: CSV 파일 내에 동명이인이 있으면 프로그램이 자동으로 제외합니다
- **아이케어 시스템에 동명이인이 등록된 경우도 입력 불가**: 검색 결과에 동명이인이 여러 명 나오면 자동으로 제외됩니다

### CSV 파일 예시

**연락처가 있는 경우:**
```
다락방,순장,이름,연락처
1층다락방,김순장,홍길동,01012345678
2층다락방,이순장,김철수,01098765432
3층다락방,박순장,이영희,01011112222
```

**연락처가 없는 경우 (빈 칸으로 두기):**
```
다락방,순장,이름,연락처
1층다락방,김순장,홍길동,
2층다락방,이순장,김철수,
3층다락방,박순장,이영희,
```

⚠️ **동명이인 주의사항:**
- CSV 파일에 "홍길동"이 2명 이상 있으면 → 자동으로 모두 제외됩니다
- 아이케어 시스템에 "홍길동"이 2명 이상 등록되어 있으면 → 검색 시 자동으로 제외됩니다
- 동명이인은 `failed_list.csv`에 기록되며, 수동으로 처리해야 합니다

---

## 프로그램 실행하기

### 1단계: CSV 파일 확인

프로그램을 실행하기 전에 `data.csv` 파일이 프로젝트 폴더에 있는지 확인합니다.

### 2단계: 명령 프롬프트(터미널)에서 실행

**Windows 사용자:**
```bash
python icare_auto_assign.py
```

**Mac 사용자:**
```bash
python3 icare_auto_assign.py
```

### 3단계: 로그인 정보 입력

프로그램이 실행되면 다음 메시지가 나타납니다:

```
아이디를 입력하세요: 
```

1. 아이케어 웹사이트의 **관리자 아이디**를 입력하고 Enter를 누릅니다
2. 다음으로 비밀번호를 입력하라는 메시지가 나타납니다:
   ```
   비밀번호를 입력하세요: 
   ```
3. 비밀번호를 입력하고 Enter를 누릅니다
   - ⚠️ 비밀번호는 화면에 표시되지 않습니다 (보안상 정상입니다)

### 4단계: 자동 실행

로그인 정보를 입력하면 프로그램이 자동으로 다음 작업을 수행합니다:

1. ✅ 크롬 브라우저가 자동으로 열립니다
2. ✅ 아이케어 웹사이트에 로그인합니다
3. ✅ CSV 파일의 각 사람에 대해 순배정 작업을 수행합니다
4. ✅ 진행 상황이 화면에 표시됩니다

### 5단계: 실행 중 화면 확인

프로그램이 실행되는 동안 다음과 같은 메시지들이 표시됩니다:

```
[2024-01-01 10:00:00] ℹ️ 로그인 정보 입력
[2024-01-01 10:00:05] ✅ 로그인 정보 입력 완료
[2024-01-01 10:00:06] ℹ️ 드라이버 초기화 시작
[2024-01-01 10:00:08] ✅ 크롬 브라우저 실행 완료
[2024-01-01 10:00:10] 🔄 로그인 프로세스 시작
[2024-01-01 10:00:15] ✅ 로그인 성공 및 쿠키 저장 완료
[2024-01-01 10:00:20] 🔄 [1/10] 처리 시작: 홍길동 → 1층다락방 / 김순장
[2024-01-01 10:00:25] ✅ 선택 완료: 홍길동
[2024-01-01 10:00:30] ✅ 배정 저장 완료: 홍길동 → 1층다락방 / 김순장
...
```

**기호 의미:**
- ℹ️ : 정보 메시지
- ✅ : 성공
- ❌ : 오류
- ⚠️ : 경고
- 🔄 : 진행 중

### 6단계: 완료 대기

프로그램이 모든 작업을 완료할 때까지 기다립니다. 브라우저는 자동으로 조작되므로 **직접 클릭하거나 조작하지 마세요**.

작업이 완료되면 다음과 같은 메시지가 나타납니다:

```
총 10명 처리 완료, 0명 실패
순배정 자동화 작업 완료
브라우저는 유지됩니다. 수동으로 종료하거나 다음 작업을 진행하세요.
브라우저 유지. 종료하려면 Enter...
```

Enter 키를 누르면 브라우저가 닫힙니다.

---

## 실행 결과 확인하기

### 성공한 경우

프로그램이 정상적으로 완료되면:
- ✅ "총 X명 처리 완료, 0명 실패" 메시지가 표시됩니다
- ✅ 아이케어 웹사이트에서 실제로 배정이 완료되었는지 확인할 수 있습니다

### 실패한 경우

일부 인원이 실패한 경우:
- ⚠️ "총 X명 처리 완료, Y명 실패" 메시지가 표시됩니다
- 실패한 인원 목록이 화면에 표시됩니다
- `failed_list.csv` 파일이 생성되어 실패한 인원 정보가 저장됩니다

### failed_list.csv 파일 확인

실패한 인원이 있는 경우, 프로젝트 폴더에 `failed_list.csv` 파일이 생성됩니다. 이 파일을 열어서 실패한 인원과 실패 사유를 확인할 수 있습니다.

파일 형식:
```
이름,연락처,다락방,순장,실패사유
홍길동,01012345678,1층다락방,김순장,검색 결과 없음
```

---

## 문제 해결 (트러블슈팅)

### 문제 1: "Python이 인식되지 않습니다"

**증상:**
```
'python'은(는) 내부 또는 외부 명령, 실행할 수 있는 프로그램, 또는 배치 파일이 아닙니다.
```

**해결 방법:**
1. Python이 설치되어 있는지 확인합니다
2. Windows의 경우, Python 설치 시 "Add Python to PATH" 옵션을 체크했는지 확인합니다
3. Python이 설치되어 있다면 `python3` 또는 `py` 명령어를 시도해봅니다
4. 그래도 안 되면 Python을 재설치합니다

---

### 문제 2: "pip가 인식되지 않습니다"

**증상:**
```
'pip'은(는) 내부 또는 외부 명령, 실행할 수 있는 프로그램, 또는 배치 파일이 아닙니다.
```

**해결 방법:**
1. `python -m pip install selenium` 명령어를 시도합니다
2. Mac의 경우 `python3 -m pip install selenium`을 시도합니다
3. Python이 제대로 설치되어 있는지 확인합니다

---

### 문제 3: "ModuleNotFoundError: No module named 'selenium'"

**증상:**
```
ModuleNotFoundError: No module named 'selenium'
```

**해결 방법:**
1. 명령 프롬프트에서 `pip install selenium`을 실행합니다
2. Mac의 경우 `pip3 install selenium`을 실행합니다
3. 설치가 완료되면 다시 프로그램을 실행합니다

---

### 문제 4: "ChromeDriver를 찾을 수 없습니다"

**증상:**
```
ChromeDriver 관련 오류 메시지
```

**해결 방법:**
1. Google Chrome 브라우저가 최신 버전인지 확인합니다
2. `pip install webdriver-manager`를 실행합니다
3. 프로그램이 자동으로 ChromeDriver를 다운로드하므로, 인터넷 연결을 확인합니다

---

### 문제 5: "CSV 파일을 찾을 수 없습니다"

**증상:**
```
'data.csv' 파일을 찾을 수 없습니다.
```

**해결 방법:**
1. `data.csv` 파일이 프로젝트 폴더에 있는지 확인합니다
2. 파일 이름이 정확히 `data.csv`인지 확인합니다 (대소문자 구분)
3. 파일이 다른 폴더에 있다면 프로젝트 폴더로 이동시킵니다

---

### 문제 6: "로그인 실패"

**증상:**
```
로그인 실패 - ID/PW 확인 필요
```

**해결 방법:**
1. 아이디와 비밀번호가 정확한지 확인합니다
2. 아이케어 웹사이트에서 직접 로그인이 되는지 확인합니다
3. 계정이 잠겨있지 않은지 확인합니다
4. 다시 프로그램을 실행하여 올바른 정보를 입력합니다

---

### 문제 7: "검색 결과 없음"

**증상:**
```
검색 결과 없음: 홍길동
```

**해결 방법:**
1. CSV 파일의 이름이 아이케어 시스템에 등록된 이름과 정확히 일치하는지 확인합니다
2. 이름에 띄어쓰기나 특수문자가 있는지 확인합니다
3. 아이케어 웹사이트에서 직접 검색해보고 이름이 정확한지 확인합니다
4. 이름이 너무 짧거나 특수한 경우, 전체 이름을 사용해봅니다

---

### 문제 8: "동명이인 발견"

**증상:**
```
동명이인 발견: 홍길동 (2명)
```

**원인:**
- CSV 파일 내에 동명이인이 있는 경우
- 아이케어 시스템에 동명이인이 등록되어 있어 검색 결과에 여러 명이 나오는 경우

**해결 방법:**
1. ⚠️ **동명이인은 자동 입력이 불가능합니다**: 프로그램이 자동으로 제외합니다
2. CSV 파일에서 동명이인을 확인합니다
3. 동명이인은 `failed_list.csv`에 기록되므로, 수동으로 아이케어 웹사이트에서 직접 처리해야 합니다
4. 또는 CSV 파일에서 동명이인 중 하나를 제외하고 다시 실행합니다 (나머지는 자동 처리)
5. 아이케어 시스템에 동명이인이 등록된 경우, 이름을 더 구체적으로 구분할 수 있는 방법이 있는지 확인합니다

---

### 문제 9: "다락방을 찾을 수 없습니다"

**증상:**
```
다락방 '1층다락방'을 찾을 수 없습니다.
```

**해결 방법:**
1. CSV 파일의 다락방 이름이 아이케어 시스템에 등록된 이름과 정확히 일치하는지 확인합니다
2. 대소문자, 띄어쓰기, 특수문자를 정확히 확인합니다
3. 아이케어 웹사이트에서 실제 다락방 이름을 확인하고 CSV 파일을 수정합니다

---

### 문제 10: "순장을 찾을 수 없습니다"

**증상:**
```
순장 '김순장'을 찾을 수 없습니다.
```

**해결 방법:**
1. CSV 파일의 순장 이름이 정확한지 확인합니다
2. 선택한 다락방에 해당 순장이 실제로 존재하는지 확인합니다
3. 아이케어 웹사이트에서 다락방과 순장의 관계를 확인합니다

---

### 문제 11: 브라우저가 너무 느리게 실행됩니다

**해결 방법:**
1. 인터넷 연결 속도를 확인합니다
2. 다른 프로그램을 종료하여 컴퓨터 성능을 확보합니다
3. Chrome 브라우저를 최신 버전으로 업데이트합니다

---

### 문제 12: 프로그램이 중간에 멈춥니다

**해결 방법:**
1. 브라우저 창을 확인하여 팝업이나 알림이 있는지 확인합니다
2. 인터넷 연결이 끊어지지 않았는지 확인합니다
3. 프로그램을 다시 실행합니다 (이미 처리된 인원은 다시 처리되지 않도록 주의)
4. 실패한 인원만 `failed_list.csv`에서 확인하여 수동으로 처리합니다

---

## 주의사항

### ⚠️ 중요한 주의사항

1. **프로그램 실행 중 브라우저 조작 금지**
   - 프로그램이 실행되는 동안 브라우저를 직접 클릭하거나 조작하지 마세요
   - 프로그램이 자동으로 모든 작업을 수행합니다

2. **CSV 파일 백업**
   - CSV 파일을 수정하기 전에 반드시 백업을 만듭니다
   - 원본 데이터를 잃어버리지 않도록 주의합니다

3. **인터넷 연결 필수**
   - 프로그램 실행 중에는 안정적인 인터넷 연결이 필요합니다
   - 연결이 끊어지면 프로그램이 오류를 발생시킬 수 있습니다

4. **동명이인 처리 (중요!)**
   - ⚠️ **동명이인은 자동 입력이 불가능합니다**
   - CSV 파일 내에 동명이인이 있으면 프로그램이 자동으로 모두 제외합니다
   - 아이케어 시스템에 동명이인이 등록되어 있어 검색 결과에 여러 명이 나오면 자동으로 제외됩니다
   - 제외된 인원은 `failed_list.csv`에 기록되므로 **수동으로 아이케어 웹사이트에서 직접 처리**해야 합니다
   - 동명이인을 피하려면 CSV 파일을 작성할 때 중복된 이름이 없는지 미리 확인하세요

5. **다락방/순장 이름 정확성**
   - CSV 파일의 다락방과 순장 이름은 아이케어 시스템에 등록된 이름과 정확히 일치해야 합니다
   - 대소문자, 띄어쓰기, 특수문자까지 정확히 입력해야 합니다

6. **쿠키 파일**
   - 프로그램이 로그인 정보를 `cookies.json` 파일에 저장합니다
   - 이 파일이 있으면 다음 실행 시 자동으로 로그인됩니다
   - 보안을 위해 이 파일을 다른 사람과 공유하지 마세요

7. **대량 처리 시 주의**
   - 수백 명을 한 번에 처리하는 경우 시간이 오래 걸릴 수 있습니다
   - 프로그램이 완료될 때까지 기다려주세요

8. **결과 확인**
   - 프로그램이 완료된 후 아이케어 웹사이트에서 실제로 배정이 완료되었는지 확인하세요
   - 실패한 인원이 있는 경우 `failed_list.csv`를 확인하여 수동으로 처리하세요

---

## 추가 도움말

### 프로그램 구조

- `icare_auto_assign.py`: 메인 프로그램 파일
- `data.csv`: 순배정할 인원 정보가 담긴 CSV 파일
- `cookies.json`: 로그인 정보가 저장되는 파일 (자동 생성)
- `failed_list.csv`: 실패한 인원 목록 (실패 시 자동 생성)

### 로그인 정보 저장

프로그램은 첫 실행 시 로그인 정보를 `cookies.json` 파일에 저장합니다. 다음 실행 시에는 자동으로 로그인되므로 아이디와 비밀번호를 다시 입력할 필요가 없습니다.

만약 로그인이 실패하거나 쿠키가 만료된 경우, `cookies.json` 파일을 삭제하고 다시 실행하면 됩니다.

### 이름 검색 방식

프로그램은 이름의 **앞 세 글자**만 사용하여 검색합니다. 이는 동명이인 문제를 최소화하기 위함입니다.

예를 들어:
- "홍길동" → "홍길동"으로 검색
- "김철수" → "김철수"로 검색

---

## 문의 및 지원

프로그램 사용 중 문제가 발생하거나 질문이 있으시면:

1. 이 README 파일의 [문제 해결](#문제-해결-트러블슈팅) 섹션을 먼저 확인하세요
2. CSV 파일 형식이 올바른지 확인하세요
3. 모든 필수 항목이 설치되어 있는지 확인하세요

---

## 버전 정보

- **프로그램 버전**: 1.0
- **Python 버전**: 3.7 이상 필요
- **Selenium 버전**: 최신 버전
- **지원 브라우저**: Google Chrome (최신 버전)

---

## 라이선스

이 프로그램은 내부 사용을 위한 도구입니다.

---

**마지막 업데이트**: 2025년

**작성자**: i-care 자동화 시스템 개발팀

---

## 빠른 시작 가이드 (요약)

1. ✅ Python 설치 확인
2. ✅ 명령 프롬프트에서 `pip install selenium webdriver-manager` 실행
3. ✅ `data.csv` 파일 준비 (다락방, 순장, 이름, 연락처 - 연락처는 선택사항, 동명이인 주의!)
4. ✅ 명령 프롬프트에서 `python icare_auto_assign.py` 실행 (Mac: `python3`)
5. ✅ 아이디/비밀번호 입력
6. ✅ 완료까지 대기
7. ✅ 결과 확인

**이 순서대로 하면 무조건 됩니다!** 

